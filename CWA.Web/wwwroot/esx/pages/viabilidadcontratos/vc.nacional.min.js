if($("#cwa-tipo-select").change(function(){const n=$(this).val(),t='<option value="">Seleccione un valor...<\/option>';$("#cwa-vendedor-select").empty().append(t);$("#cwa-comprador-select").empty().append(t);$(".cwa-doc-row").remove();n&&$(cwa.page.tipos).each(function(){const t=this;if(n==t.id){t.refVal4==cwa.page.targets.dist&&(cwa.page.usuario.gen.id!=0?$("#cwa-vendedor-select").empty().append('<option value="'+cwa.page.usuario.gen.id+'">'+cwa.page.usuario.gen.nombre+"<\/option>"):$(cwa.page.agentes.generadores).each(function(){$("#cwa-vendedor-select").append('<option value="'+this.value+'">'+this.text+"<\/option>")}),cwa.page.usuario.dist.id!=0?$("#cwa-comprador-select").empty().append('<option value="'+cwa.page.usuario.dist.id+'">'+cwa.page.usuario.dist.nombre+"<\/option>"):$(cwa.page.agentes.distribuidoras).each(function(){$("#cwa-comprador-select").append('<option value="'+this.value+'">'+this.text+"<\/option>")}));t.refVal4==cwa.page.targets.gen&&(cwa.page.usuario.gen.id!=0&&($("#cwa-vendedor-select").append('<option value="'+cwa.page.usuario.gen.id+'">'+cwa.page.usuario.gen.nombre+"<\/option>"),$("#cwa-comprador-select").append('<option value="'+cwa.page.usuario.gen.id+'">'+cwa.page.usuario.gen.nombre+"<\/option>")),$(cwa.page.agentes.generadores).each(function(){$("#cwa-vendedor-select").append('<option value="'+this.value+'">'+this.text+"<\/option>")}),$(cwa.page.agentes.generadores).each(function(){$("#cwa-comprador-select").append('<option value="'+this.value+'">'+this.text+"<\/option>")}));var i=0;$(cwa.page.docs.doctipos).each(function(){const n=this;t.id==n.contrato&&$(cwa.page.docs.documentos).each(function(){const t=this;var r="cwa-documentos";n.documento==t.id&&(r=cwa.page.functions.createBinded(t.id,t.descripcion,t.accepts,i,r),i++)})})}})}),cwa.page.functions={selectChanged:function(n,t){const i=$("#cwa-tipo-select").val();i&&$(cwa.page.tipos).each(function(){const r=$("#"+n).val(),f=$("#"+t).val(),u=this;i==u.id&&u.refVal4==cwa.page.targets.gen&&cwa.page.usuario.gen.id!=0&&(r==cwa.page.usuario.gen.id?f==cwa.page.usuario.gen.id&&$("#"+t).val(""):r!=""&&$("#"+t).val(cwa.page.usuario.gen.id))})},createBinded:function(n,t,i,r,u){const f="cwa-documento-"+r,e="EditModel_Documentos_"+r+"__DocumentUpload",o="EditModel.Documentos["+r+"].DocumentUpload",s="EditModel_Documentos_"+r+"__TipoDocumentoId",h="EditModel.Documentos["+r+"].TipoDocumentoId",c='<input class="form-control" type="file" data-val="true" data-val-required="El documento es requerido" id="'+e+'" name="'+o+'" accept="'+i+'" />',l='<input type="hidden" data-val="true" data-val-required="El tipo de documento es requerido." id="'+s+'" name="'+h+'" value="'+n+'" />',a='<span id="EditModel-Documentos-'+r+'-DocumentUpload" class="text-danger cwa-small">&nbsp<\/span>',v='<div id="'+f+'" class="row cwa-doc-row"><div class="col-12 mb-3"><label for="'+e+'">'+t+"<\/label>"+c+a+l+"<\/div>";return $(v).insertAfter("#"+u),f}},$("#cwa-vendedor-select").change(function(){cwa.page.functions.selectChanged("cwa-vendedor-select","cwa-comprador-select")}),$("#cwa-comprador-select").change(function(){cwa.page.functions.selectChanged("cwa-comprador-select","cwa-vendedor-select")}),cwa.page.ct={update:$("#cwa-update-button"),approve:$("#cwa-approve-button"),reject:$("#cwa-reject-button"),rejection:$("#cwa-rejection-button"),back:$("#cwa-back-link"),text:$("#cwa-motivo-rechazo")},cwa.page.showUpdate&&$(cwa.page.ct.update).click(function(){cwa.dialog.ask(cwa.page.strings.guardar,"#cwa-update-form",function(){cwa.page.jsonResult.success==!0&&document.querySelector("#cwa-back-link").click()})}),cwa.page.showApprove==!0&&$("#cwa-approve-button").click(function(){cwa.dialog.ask(cwa.page.strings.aprobar,"#cwa-approve-form")}),cwa.page.showApprove==!0){$("#cwa-reject-button").click(function(){cwa.dialog.ask(cwa.page.strings.rechazar,"#cwa-reject-form")});$(cwa.page.ct.text).on("show.bs.collapse",function(){$(cwa.page.ct.rejection).find("span").text("Cancelar");$(cwa.page.ct.reject).show();$(cwa.page.ct.approve).hide();$(cwa.page.ct.back).hide()}).on("hide.bs.collapse",function(){$(cwa.page.ct.rejection).find("span").text("Rechazo");$(cwa.page.ct.reject).hide();$(cwa.page.ct.approve).show();$(cwa.page.ct.back).show()}).on("shown.bs.collapse",function(){$("textarea").trigger("focus")})}cwa.page.complete=function(){cwa.page.jsonResult.success==!0?(cwa.page.jsonResult.content=="update"&&$(".cwa-small").html("&nbsp;"),cwa.page.jsonResult.content=="approved"&&(cwa.settext("#cwa-approve-date",cwa.page.jsonResult.timeString),cwa.settext("#cwa-approved",cwa.page.strings.aprobado),$("#cwa-approved-icon").hasClass("bi-clock-fill")&&($("#cwa-approved-icon").removeClass("bi-clock-fill").removeClass("text-warning"),$("#cwa-approved-icon").addClass("bi-check-circle-fill").addClass("text-success")),$(cwa.page.ct.back).show(),$(cwa.page.ct.rejection).remove(),$(cwa.page.ct.approve).remove(),$(cwa.page.ct.reject).remove(),$(cwa.page.ct.update).remove(),$(cwa.page.ct.text).remove()),cwa.page.jsonResult.content=="rejected"&&(cwa.settext("#cwa-approve-date",cwa.page.jsonResult.timeString),cwa.settext("#cwa-approved",cwa.page.strings.noaprobado),$("#cwa-approved-icon").hasClass("bi-clock-fill")&&($("#cwa-approved-icon").removeClass("bi-clock-fill").removeClass("text-warning"),$("#cwa-approved-icon").addClass("bi-exclamation-circle-fill").addClass("text-danger")),cwa.settext("#cwa-motivo-span",$("textarea").val()),$("#cwa-motivo-div").removeClass("d-none"),$(cwa.page.ct.back).show(),$(cwa.page.ct.rejection).remove(),$(cwa.page.ct.approve).remove(),$(cwa.page.ct.reject).remove(),$(cwa.page.ct.update).remove(),$(cwa.page.ct.text).remove())):cwa.page.jsonResult.content&&cwa.setErrorMessages(cwa.page.jsonResult.content)};